/*! y9.Accordion@0.0.4.js @ 2017, yamoo9.net */!function(t,i,e){"use strict";var n={active_class:"is-active",nested_class:"is-nested",animate_class:"is-animate",focus_class:"is-focus-ring",level_class:"lv-",active_index:null,close_all:!0,radio:!1,animate:!1,duration:300,easing:"swing",aria:!0,structure:{accordion:"y9-accordion",item:"item",header:"heading",button:"button",panel:"panel",divider:"__"}},s=0;e.Accordion=function(t,n,s){this.level=s||1,this.g_id=null,this.options=i.extend(!0,{},e.Accordion.defaults,n),this.$el=i(t),this._current=null,this._pre=null,this._items=[],/In|Out/.test(this.options.easing)?i.getScript("https://unpkg.com/jquery-easing@0.0.1/dist/jquery.easing.1.3.umd.min.js",i.proxy(this,"_init")):this._init()},i.extend(e.Accordion.prototype,{_init:function(){var t=this;1===t.level&&(t.g_id=++s),t.$el.children().each(function(i,n){t._items.push(new e.AccordionItem(n,i,t))});var n=this.options.active_index;"number"===i.type(n)&&1===this.level&&this.active(this.options.active_index),"number"===i.type(n)||this.options.close_all||this.active(0),this._setup(),this._bind()},_setup:function(){var t=this.$el,i=this.options,e=i.structure;t.data("component",this),1===this.level&&(t.data("generated_id",this.g_id),t.addClass(e.accordion)),t.children().addClass(e.accordion+e.divider+e.item),t.addClass(i.level_class+this.level),1===this.level&&i.animate&&t.addClass(i.animate_class),i.aria&&t.attr({role:"presentation"})},_bind:function(){this.$el.on("deactive",i.proxy(this,"deactive"))},items:function(t){var e=i.type(t);if("undefined"!==e&&"number"!==e)throw".items(n) 숫자를 전달해야 합니다.";return"undefined"===e?this._items:t<0?this._items[this._items.length-1]:this._items[t]},nestedItems:function(t,e){var n=i.type(t),s=[];if("undefined"!==n&&"number"!==n)throw".items(n) 숫자를 전달해야 합니다.";return"undefined"===n?i.each(this.items(),function(t,i){s=s.concat(i.nested)}):s=t<0?this.items(-1).nested:this.items(t).nested,"number"!==i.type(e)?s:s[e]},active:function(t){var e=i.type(t);if("undefined"===e||"undefined"!==e&&"number"!==e)throw".active(n) 숫자를 전달해야 합니다.";this.items(t).expand()},deactive:function(){var t=this._pre;"null"!==i.type(t)&&this.items(t).collapse()},isPanelOnlyOneOpened:function(){var t=0;return i.each(this._items,function(i,e){e.isExpanded()&&(t+=1)}),1===t},updatePreCurrent:function(t){for(var i,e=this._items,n=0,s=e.length;n<s;n++)if((i=e[n]).isExpanded()){this._pre=i._index;break}this._current=t},openedItemsCount:function(){var t=this.options,e=0;return i.each(this.items(),function(i,n){n.$heading.hasClass(t.active_class)&&e++}),e},prev:function(){var t=this.items().length-1;this._current=--this._current<0?t:this._current,this.items(this._current).$button.focus()},next:function(){var t=this.items().length-1;this._current=++this._current>t?0:this._current,this.items(this._current).$button.focus()},first:function(){this.items(0).$button.focus()},last:function(){this.items(this.items().length-1).$button.focus()}}),e.Accordion.defaults=n,e.AccordionItem=function(t,e,n){this.$item=i(t),this._index=e,this._parent=n,this.options=this._parent.options,this.$heading=null,this.$panel=null,this.nested=[],this._init()},i.extend(e.AccordionItem.prototype,{_init:function(){var t=this.$item.children();this.$heading=t.first(),this.$button=this.$heading.children("a, button"),this.$panel=t.last(),this._setup(),this._bind(),this._nested()},_setup:function(){var t=this.options,i=t.structure,e=i.accordion+i.divider,n=this.$heading,s=this.$button,a=this.$panel;if(n.addClass(e+i.header),s.addClass(e+i.button),a.addClass(e+i.panel),t.aria){var r=this._parent.g_id,o=this._parent.level,h=this._index+1;if(1!==o){var d=new RegExp("--g([0-9]+)");r=this._parent.$el.attr("id").match(d)[1]}var c="--g"+r+"."+o+"."+h,l=e+i.button+c,u=e+i.panel+c;n.is(":header")||n.attr({role:"heading","aria-level":(o+=2)<=6?o:6}),s.is("button")||s.attr({role:"button"}),s.attr({id:l,"aria-controls":u,"aria-expanded":!1}),a.attr({role:"region",id:u,"aria-labelledby":l})}},_bind:function(){this.$button.on("click",i.proxy(this,"toggle")),this.$button.on("keyup",i.proxy(this,"_keyInteraction"))},_nested:function(){var t=this,i=this._parent,n=this.options,s=this.$panel.filter("."+n.nested_class);s.length>0&&s.each(function(s,a){t.nested.push(new e.Accordion(a,n,i.level+1))})},_keyInteraction:function(t){t.preventDefault();var i=t.which||t.keyCode,e=(this.options,this._parent);switch(i){case 38:e.prev();break;case 40:e.next();break;case 36:e.first();break;case 35:e.last()}2===e.level&&t.shiftKey&&33===i&&this.rootPrev(),2===e.level&&t.shiftKey&&34===i&&this.rootNext()},expand:function(){var t=this._parent,i=this.options;t.updatePreCurrent(this._index),i.radio&&t.$el.trigger("deactive"),this.$heading.addClass(this.options.active_class),i.animate?this.$panel.slideDown(i.duration,i.easing):this.$panel.show(),i.aria&&(this.$button.attr({"aria-expanded":!0}),i.close_all||1!==t.openedItemsCount()||this.$button.attr("aria-disabled",!0))},collapse:function(){var t=this._parent,i=this.options;!i.radio&&!i.close_all&&t.isPanelOnlyOneOpened()||i.radio&&!i.close_all&&t._current===this._index||(this.$heading.removeClass(this.options.active_class),i.animate?this.$panel.slideUp(i.duration,i.easing):this.$panel.hide(),i.aria&&(this.$button.attr({"aria-expanded":!1}),i.close_all||t.items(t._pre).$button.attr("aria-disabled",!1)))},toggle:function(t){t.preventDefault(),"number"===i.type(this._parent._current)&&this.isExpanded()?this.collapse():this.expand()},isExpanded:function(){return this.$panel.is(":visible")},rootPrev:function(){this._parent.$el.parents("."+this.options.structure.accordion).data("component").prev()},rootNext:function(){this._parent.$el.parents("."+this.options.structure.accordion).data("component").next()}})}(window,window.jQuery,window.y9=window.y9||{});